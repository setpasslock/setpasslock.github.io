---
layout: post
title: "TCP ve IP Protokollerini Anlamak 1"
---
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>TCP ve IP Protokollerini Anlamak 1</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-interactiveBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-translucentGray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="c4ccc2c7-abbf-4657-9f82-f825fda32f24" class="page sans"><header><h1 class="page-title">TCP ve IP Protokollerini Anlamak 1</h1><p class="page-description"></p></header><div class="page-body"><p id="c844bf50-bd62-4ae1-98f7-bc9333a26662" class="">Bu seride TCP ve IP protokollerini, nasıl çalıştıklarını ince ayrıntılarıyla anlamak için derin bir dalış yapacağız. Bu yazı iki seri şeklinde olacak ve ilk yazı TCP’yi anlatırken ikinci yazı IP’yi anlatacak. Bahsedeceğimiz <strong>TCP</strong> ve <strong>IP</strong> protokolleri ile <strong>TCP/IP</strong> modelinin aynı şeyi ifade etmediğini önceden belirtmekte fayda var. Malum ilk iki kavram protokolken, TCP/IP <strong>OSI modelinden sonra</strong> benimsenen <strong>mantıksal model yaklaşımı</strong>. Her ne kadar TCP/IP modeli güncel olsa da bu anlatımda klasikçi olup OSI modelini kullanacağım.</p><p id="4d2f2488-df42-4d6d-a46e-2b99c25aa7ab" class="">Bildiğiniz üzere OSI modeli network’ün nasıl çalıştığını anlamamızı sağlayan <strong><strong><strong><strong><strong><strong><strong><strong><strong>mantıksal</strong></strong></strong></strong></strong></strong></strong></strong></strong> bir modeldir. Bunu birçok defa duydunuz ama mantıksal olduğu için gözünüzde canlanmıyorsa hiç merak etmeyin, uygulamalarla kanlı canlı olarak karşınıza çıkartacağım onu. Biz bu seride OSI üzerinden <strong>Transport</strong> ve <strong>Network</strong> katmanlarına odaklanacağız, çünkü anlamaya çalıştığımız protokoller TCP ve IP protokolleri. Çadırınız, erzaklarınız, oksijen tüpünüz, kahveniz, nefes almanıza yarayan her şeyi alın, atlayacağız..</p><figure id="9a8b2443-95ac-4de8-8680-dbcb1146336b" class="image"><a href="/assets/imgTCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled.png"><img style="width:744px" src="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled.png"/></a></figure><p id="ce0ee0e0-c974-4324-8e1d-182621811f2e" class="">Mevzu bahis yukarıda da şeklini gördüğünüz OSI modelinin amacı <strong>networkü oluşturan yazılım ve donanımlar arasındaki ilişkiyi modelleyebilmemizi sağlamak.</strong> Bir diğer deyişle networkün sahip olduğu işlevleri kategorize etmemizi sağlar. Bu kategoriler oluşan sorunları tespit ederken ilgisiz yerlere bakarak vakit kaybetmemize gerek kalmadan soruna odaklanabilmemize yardımcı olur. Örneğin internet kablonuz kesikse (Physical Layer sorunu) acaba sorun HTTP isteğinin düzgün gitmemesi mi (Application Layer sorunu) diye düşünmezsiniz. </p><h2 id="30ca5f92-79b3-40d9-a118-37c012839d7e" class="">Transport Layer</h2><p id="13ca0503-43da-4c0f-85a0-0f813061d2ba" class="">OSI modelinde bu katman veri iletişiminin <strong>güvenilir</strong> ve <strong>düzenli</strong> bir şekilde gerçekleştirilmesini sağlamakla görevlidir. <div class="indented"><p id="d8f22d5c-f9ea-4ac7-aedb-5d0b1ccaa94f" class="">Buradaki güvenilir kelimesine de bir açıklık getirmek gerekiyor. Bilgi güvenliğinde bir bilginin güvenli kabul edilebilmesi için 3 temel ilkeye sahip olması gerekli. </p><ol type="1" id="e30f8e49-768e-4a73-8eb2-232a72725bd9" class="numbered-list" start="1"><li>Gizlilik - Bilgiye yetkisi olmayanlar erişememeli</li></ol><ol type="1" id="74b1dbf0-6997-46a8-a716-7b7ce02119d1" class="numbered-list" start="2"><li>Bütünlük - Bilgi olduğu gibi kalmalı, yetkisiz aktörler tarafından değiştirilemez olmalıdır.</li></ol><ol type="1" id="6caf9c65-6e78-4a77-a236-56311ffae3aa" class="numbered-list" start="3"><li>Erişilebilirlik - Bilgi yetkisi olan aktörler tarafından erişilebilir olmalıdır.</li></ol><p id="7cc25219-9331-431f-ac84-8242e2d3428c" class="">Güvenlik denilince akla genelde gizlilik faktörünün sağlanması geldiği için bu açıklamayı yapmamız gerekti. Çünkü bu katmanda bütünlüğü sağlamak için verilen çaba çok şey anlamına geliyor. Bir bilginin güvenli olarak kabul edilebilmesi için bunlardan sadece birine sahip olması yeterli değildir. Bunlardan hepsini sağlıyor olması o bilgiyi güvende tutar. Network’teki her trafiğimizin bir bilgi olduğunu ve güvenlikten bahsederken aslında bu 3 ilkeyi de korumaya çalıştığımızı unutmayın bu yüzden. Devam ediyoruz.</p><p id="9795be19-de1a-411f-a0ff-f60dab7d9448" class="">
</p></div></p><p id="5f8ef9fb-69ee-4690-8a8d-590994f51ce6" class="">Örneklere girmeden önce bilmeniz gereken bazı özellikleri de var bu katmanın. Bunları şimdilik başlık halinde açıklayacağım, TCP’yi anlatırken de bunlara uzun uzun değinmiş olacağız.</p><ul id="242c2d71-6391-4ed0-a73f-1397d2bedf56" class="bulleted-list"><li style="list-style-type:disc">Port Yönetimi</li></ul><ul id="509eadb9-4749-4133-8e4c-806c6c0c846f" class="bulleted-list"><li style="list-style-type:disc">Bağlantı Yönetimi</li></ul><ul id="d5fe7cbb-000c-4288-9fb1-fafd5b3dcaf9" class="bulleted-list"><li style="list-style-type:disc">Hata Kontrolü ve Düzeltme</li></ul><ul id="9c0a93cd-3923-477b-86a2-699d44d7fbbe" class="bulleted-list"><li style="list-style-type:disc">Akış Kontrolü</li></ul><ul id="c6935d48-b14f-4aef-bb95-5ef9dfd9937b" class="bulleted-list"><li style="list-style-type:disc">Veri Segmentasyonu ve Birleştirme</li></ul><p id="22c65e1c-fffe-4ea9-9dfc-f11acc50707c" class="">
</p><h2 id="1c919d0d-6642-4727-a01d-a6193550cecc" class="">Transmission Control Protocol (TCP)</h2><p id="cff28a70-b4b1-4685-a5a3-7a11b381d76f" class="">Öncelikle daha anlaşılır kılmak için bir TCP paketi modelini size göstereyim. Biraz soluklanıp buna bakmak isteyebilirsiniz. TCP konuşurken <strong>segment</strong> adındaki bir kavram bizim için önemli. TCP veri gönderimi yaparken verileri küçük parçalar halinde gönderir. Burada transport layer’daki her parçaya segment denir. Konuyu anlatırken gözünüzde canlandırmanın kolay olması için segment yerine <strong>TCP paketi</strong> ifadesini kullanacağım, aynı anlama da gelecek, ama siz bir segment ile paketin farklı şeyler ifade ettiğini bilin. Bu yüzden düz paket değil TCP paketi olarak niteliyoruz.  </p><figure id="44e06511-ca8a-47f3-99f3-274fe5b13f6e" class="image"><a href="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%201.png"><img style="width:500px" src="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%201.png"/></a></figure><p id="5cd099e6-ed61-456f-9a75-d9b30ee5c29b" class="">OSI katmanını canlı kanlı göstereceğimi söylemiştim. Sözümde durma vakti. Wireshark’ı açıp gelen giden rastgele paketlerden bir TCP paketi yakalayıp onu analiz ederek iyice anlayacağız. Bir serverdan bana gelen bir paketi rastgele olarak seçtim.</p><figure id="5920db53-a5f3-4698-92e9-1f778c255f46" class="image"><a href="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%202.png"><img style="width:1241px" src="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%202.png"/></a></figure><p id="73dc10f5-3fc1-41c5-95c6-4c95cc901273" class="">MAC adresini sansürlemekten doğan görüntü kirliliği için önce bir özür. En yukarıda mavi ile işaretli olan kısım seçtiğimiz paket. Sol alt köşedeki kısım ilgimizi çekiyor, çünkü wireshark oradaki bilgileri OSI katmanına göre kategorize edip bize sunuyor. Şimdilik neden 4 farklı katman gözüküyor kısmını geçelim, burada dikakt etmemiz gereken bize sunulan verilerin OSI’ye göre sunulduğunu ve bununla birlikte bir protokolü incelerken nereye bakacağımızı öğrenmiş olmamız. <strong>Transmission Control Protocol</strong> kısmını açarak TCP paketimizi incelemeye başlayalım. </p><figure id="a91e0214-833b-48da-8b1e-e178b778031e" class="image"><a href="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%203.png"><img style="width:860px" src="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%203.png"/></a></figure><h3 id="3da7f0eb-9241-48f5-9a36-16c4b77263e7" class="">1) Source Port - Destination Port</h3><p id="f6343cea-b7b3-40f0-b246-5b801c010f26" class="">Başlıklar halinde yazdığım özelliklerden ilki olan <strong>port yönetimi </strong>kavramını anlamaya çalışacağız. Öncelikle bu paketin karşı serverdan bize gelen bir paket olduğunu hatırlayalım. Burada source port’u 443 olarak destination port ise 38626 olarak kaydedilmiş. Buradan bu paketin karşı server’ın 443 (HTTPS) portundan çıktığını, bizim bilgisayarımıza ise 38626 portundan girdiğini görüyoruz. Port kavramını tam olarak oturtamamışsanız, bunları bilgisayarınıza verinin giriş çıkış yaptığı mantıksal kapılar olarak hayal edebilirsiniz. Böylelikle bilgisayarınızda olan veri dışarıya nereden çıkacağını ya da dışarıdan içeriye nereye gireceğini bilir. Bu port yönetiminin sağlanması size browserınızda bir yandan youtube’dan şarkı dinlerken diğer yandan twitter’da gezmenizi aynı zamanda whatsapp’tan arkadaşınızın size yazdığı mesajın size ulaşmasını ve sizin de bunu cevaplamanızı sağlar. Tüm bu bilgisayarınızdan giren ve çıkan trafik, bu katmanda, nereden nasıl girip çıkacağı sizin yerinize yönetilir ve siz fark etmezsiniz bile. Waow, gerçekten böyle bir hizmeti size kral olsanız yapmazlar. Devam edelim :)</p><h3 id="4404a31a-9460-4682-9839-43420654764e" class="">2) Flags</h3><p id="09b12160-9306-4773-9f40-a5778fb29266" class="">Aslında atlayarak gitmiyoruz rahat olun. Sadece bazı kavramları önce anlamanız sonraki kavramları daha kolay anlamanızı sağlayacak. Burada <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>bağlantı yönetimi </strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>özelliğinden bahsedeceğiz. Transport Layer <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>bağlantıyı başlatma, sürdürme </strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>ve<strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong> sonlandırma </strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>özelliğini de taşır. Ama devam etmeden önce size Three-Way Handshake’den bahsetmem gerekiyor. </p><p id="3b9996c8-d7d5-4549-977f-3d924cb7fb2c" class="">Three way handshake server ile client’ın birbirini doğrulaması için gerekli bir bağlantı sürecidir. Bu aynı zamanda server ile aranızda olan <strong>bağlantıyı başlatan</strong> ilk temastır. Bunu farklı bir wireshark örneği ile gösterelim. </p><p id="3a69287d-3aed-475a-ad3d-54c34a4c3481" class="">Örneğin medium.org’da bir makale linkine tıkladık. Arkada her şeyden önce oluşacak ilk bağlantılar şunlar olacaktır:</p><figure id="2d0bfa98-e77a-44f7-ad71-0a30f7042f8c" class="image"><a href="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%204.png"><img style="width:760px" src="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%204.png"/></a></figure><p id="bec1891e-6fe6-43b1-ab50-6e1ec4845eb0" class="">En sağda port numaraları yanında gösterilen [SYN], [SYN, ACK], [ACK] ifadelerini dikkatinizi verin. başta 192.168.1.100 yani bizim cihazımızdan karşı server’a bir SYN ile işaretlenmiş paket gidiyor. Buna server tarafından SYN+ACK ile cevap veriliyor. Ve biz de 3. olarak buna ACK ile işaretli bir paket gönderiyoruz. Artık el sıkışmamız tamamlandı, data transferleri yapmaya hazırız. </p><p id="392691ad-5390-4254-aab8-ff8cd86e5778" class="">
</p><p id="3b5c9903-f344-4c4e-8895-34c03c2e76f2" class="">Tüm bunları anlatmamın bir sebebi var. Aslında SYN ile işaretli paket TCP’de SYN flag’i ile işaretlenen paket anlamına geliyor. Bu da 1 bitlik bir değerin segmentte işaretlenmiş olması anlamına geliyor. Gözünüzde hala canlanmadı mı? Göstereyim. </p><p id="1a0f007f-3502-4388-a6e1-f300c13d7ebd" class="">Yukarıdaki three way handshake örneğimizdeki ilk paketin içeriğini açıyorum, TCP kısmını açınca flags altında şu manzara ile karşılaşıyoruz.</p><figure id="d506fa0a-5ada-4d7f-ada9-989799c37684" class="image"><a href="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%205.png"><img style="width:450px" src="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%205.png"/></a></figure><p id="3e51198e-6520-4b5a-8d7c-6d70f9683dbd" class="">Gördüğünüz üzere diğer değerlerin hepsi 0’ken Syn değeri 1 olarak set edilmiş. Bir diğer pakete geçtiğimizde ise:</p><figure id="0695c748-9654-4e4f-9bf5-077676f94e26" class="image"><a href="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%206.png"><img style="width:458px" src="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%206.png"/></a></figure><p id="8150831b-a433-4c39-b22d-865934768901" class="">Burada da SYN ve ACK bitlerinin 1 olarak set edildiğini görüyoruz. Yani karşı server bunlara bakarak bir paketin ne olduğunu anlıyor ve ona uygun olarak tepki veriyor. İşte tam bu olay port taraması dediğimiz şeyin nasıl gerçekleştiğinden tutun DoS saldırılarına kadar olan güvenlik problemlerinin temelini oluşturuyor, ama bu başka bir yazının konusu :)</p><p id="1806ea17-364c-4613-9a2b-31b4c858daa9" class="">Şimdilik bir TCP paketinde işaretlenen flaglerle server ile aramızda bağlantı başlatabilecek güce sahip olduğumuzu anladık. Peki ya<strong> bağlantının bütünlüğü?</strong></p><p id="4531b503-517f-47c3-8f49-bc2d0df1cc54" class="">Bağlantının bütünlüğünü, tarafların el sıkışmayı tamamlamalarından sonra birbirlerine karşılıklı olarak ACK biti ile işaretli paketler göndermesi ile <strong>onaylanır</strong>. Bunun en iyi örneği bizim rastgele olarak yakaladığımız ilk paketimizde işaretli olan ACK biti. Bu bit aslında bir önceki paketin düzgün bir şekilde alındığının bir onayı işaretidir. Eğer bit işaretlenmezse veriler bütün şekilde gönderilmemiş demektir ve gönderilmeyen verilerin yeniden gönderileceği böylelikle belli olur. ACK biti aynı zamanda Acknowledgement Number değerinin kullanılması gerektiğini de belirtir. Ama bu değerin ne anlam ifade ettiğini daha sonra açıklayacağız. </p><p id="d024acbd-6867-4a57-803d-90a279da9182" class="">
</p><p id="7c75697a-4134-4a2e-bbec-7ab683811f67" class="">Şimdi bir de diğer flaglerin ne anlama geldiğine bakalım.</p><ul id="d2a1d28c-5a8f-42fe-b695-8beb755ba46a" class="bulleted-list"><li style="list-style-type:disc"><strong>Reserved: </strong>Her biri 3 bit uzunluğunda toplam 6 adet &quot;Reserved&quot; biti bulunmaktadır.<strong> </strong>gelecekte olası kullanımlar veya genişletmeler için ayrılmıştır. Bu bitler şu anda kullanılmıyor fakat gelecekte TCP protokolünün geliştirilmesi veya özelliklerin eklenmesi durumunda kullanılabilirler. Sıradaki.</li></ul><ul id="f4c6b71f-f20e-4465-a8ee-c0dafb823255" class="bulleted-list"><li style="list-style-type:disc"><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>Accurate ECN (Explicit Congestion Notification): </strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>Tıkanıklık durumlarını yani network ve yoğunluğu işaretlemek için kullanılır. Geleneksel ECN mekanizması, daha sonra göreceğimiz IP paketinde ToS (Type of Service) alanındaki 2 bitin kullanılmasıyla işaretlenir. Bu sayede ağdaki tıkanıklıkların tespit edilmesi ve veri iletiminin daha etkin bir şekilde sağlanması amaçlanır.</li></ul><ul id="b7d44b43-f987-4427-b5f0-b9df0db77127" class="bulleted-list"><li style="list-style-type:disc"><strong><strong><strong>Congestion Window Reduced: </strong></strong></strong>CWR biti, TCP protokolünde tıkanıklık durumu algılandığında kullanılır. Tıkanıklık oluştuğu bildirimine tepki verildiğini belirtmek için işaretlenir. <p id="877d1c65-0c33-4b78-9aa6-abf74040b7c6" class=""><strong>Örneğin</strong> client servera bir dosya yüklüyor, ancak aynı servera birden çok dosya yükleniyor. Server’ın ağında bir tıkanıklık meydana geldi ve server ECN-Echo işaretli bir bit’i client’a sakin ol kardeş diyerek gönderdi. Client’da pardon abicim diyerek yükleme hızını düşürdü ve gönderdiği paketlerden birine CWR işaretleyerek bunu servera bildirdi.</p></li></ul><ul id="9f72c065-6263-49a0-94e7-70c5a53c3b58" class="bulleted-list"><li style="list-style-type:disc"><strong>ECN-Echo (Explicit Congestion Notification-Echo): </strong>Bu bit de alıcı tarafından ACK (Acknowledgment) paketleri ile göndericiye tıkanıklık durumunun gerçekleştiğini bildiren bir işarettir. Eğer yukarıdaki örnekten devam edersek server’ın client’a yavaş ol kardeş deme şeklidir. <p id="8e57317f-e912-42bf-96b0-ebe77b53878b" class="">Eğer son cümleyi okuduktan sonra sizin de DoS alertleriniz çaldıysa bu konuda bu kadar acele etmeyin. Tam <a href="https://www.geeksforgeeks.org/ecn-ecn-wait-ecn-tryonce-and-alternative-backoff-with-ecn-abe/">burada</a> ilginizi çekecek bir link bırakıyorum.</p></li></ul><ul id="4f7594e6-c3b0-4b16-a7c2-8d34dae67ed3" class="bulleted-list"><li style="list-style-type:disc"><strong>URG</strong>: Urgent Pointer değerinin kullanılması gerektiğini belirtir. Bu flag, bir TCP paketinin önemli bir mesajı taşıdığını gösterir ve bu mesajın anında teslim edilmesi gerektiğini belirtir. Acil gönderilecek öncelkli paketlerde bu kısmın değeri 1 yapılır.<p id="eb64b767-6bae-4a0b-b367-3955903fb471" class=""><strong>Örneğin</strong>, bir SSH bağlantısında, bu flag kullanılarak bir kullanıcının bir ctrl+c komutu girdiğini belirtmek için kullanılabilir.</p></li></ul><ul id="2c77e8d6-ad05-4e64-aaf6-dd146f33cd28" class="bulleted-list"><li style="list-style-type:disc"><strong>Push</strong>: Verinin anında teslim edilmesini gerektirdiğini belirtir. Bu flag, bir TCP paketinin verisinin anında teslim edilmesi gerektiğini belirtir ve bu sayede, verinin bir kerede tümünün alınması sağlanır. </li></ul><ul id="4f41a776-60d8-42bf-b82e-f9ea7b90e740" class="bulleted-list"><li style="list-style-type:disc"><strong>Reset</strong>: Bağlantıyı resetlemek için kullanılır.<p id="9db2fdad-53a9-4353-8af8-8af24f336ed3" class=""><strong>Örneğin</strong>, bir web browser uygulamasında, bu flag kullanılarak <strong>bir kullanıcının bir sayfayı yeniden yüklediğini belirtmek için</strong> kullanılabilir. Benzer şekilde, bir FTP uygulamasında, bu flag kullanılarak bir kullanıcının bir dosya indirme işlemini iptal ettiğini belirtmek için de kullanılabilir.</p></li></ul><ul id="1598dbf9-1d7b-4a22-8806-4ba1bb7c2132" class="bulleted-list"><li style="list-style-type:disc"><strong>FIN</strong>: Bağlantının sonlandırılması<strong> için kullanılır</strong>. Bu flag, bir TCP paketinin verisinin iletimini sonlandırdığını belirtir ve bu sayede, <strong>verinin iletimi tamamlandığını gösterir. </strong><p id="0ee5fae0-fa9c-4235-bd69-098e372b763d" class=""><strong>Örneğin </strong>bir web tarama uygulamasında, bu flag kullanılarak bir<strong> kullanıcının bir web sayfasını kapattığını </strong>belirtmek için kullanılabilir.</p></li></ul><p id="a3fffb61-6825-4f3b-a925-b65bf1310a72" class="">
</p><p id="cac6b0bd-2aaa-4063-9658-b55fbf401fa6" class="">Böylelikle flagleri anladığımızı düşünüyor ve paket analizimize devam ediyoruz.</p><h3 id="000ca1fe-a029-496a-82b6-c71813360c2c" class="">3) Sequence Number - Acknowledgment Number</h3><p id="114cc385-ad1d-47f1-a594-bbd97b19fa0b" class="">Öncelikle sizi yukarıdaki fotoğrafa dönme zahmetinden kurtarayım. Aşağıdaki ilk seçtiğimiz rastgele TCP paketindeki sequence ve acknowledgment numberlar. Buradaki [Next Sequence Number] TCP paketinde yer almaz, wireshark’ın analizi kolaylaştırmak için sunduğu bir özellik. Ne işe yaradığını birazdan anlayacaksınız.</p><figure id="aec7b7d3-a79e-4eb5-aee6-74748b416889" class="image"><a href="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%207.png"><img style="width:356px" src="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%207.png"/></a></figure><p id="a5664a30-0fb9-4576-97cf-b5581dbf5831" class="">Bu aşağıdakiler ise sırasıyla three way handshake örneğimizde yakaladığımız tcp paketlerindeki sequence ve acknowledgment numberlar. Fotoğraflar sırasıyla SYN, SYN+ACK, ACK paketlerini gösterir.</p><figure id="a9aed508-6434-4e89-bd94-e1075f8348a5" class="image"><a href="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%208.png"><img style="width:369px" src="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%208.png"/></a></figure><figure id="24856116-c790-4d6a-bf60-0d5523a28b6b" class="image"><a href="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%209.png"><img style="width:335px" src="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%209.png"/></a></figure><figure id="92c21f87-4697-4ad8-a2cd-b07a1cb7db16" class="image"><a href="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%2010.png"><img style="width:354px" src="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%2010.png"/></a></figure><p id="c8fdd323-0226-495d-8b88-ee19c562e1b1" class="">Eveet, örneklerimiz hazır olduğuna göre başlayabiliriz. İlk TCP bağlantısını başlatan taraf SYN ile işaretlemiş olduğu TCP paketine bir sequence number ekleyerek (773125149) TCP paketine bir sıra numarası belirler. Bu arada bu sequence numberlar rastgele olarak değil, TCP paketinin içerdiği verinin miktarına göre oluşturulan bir değer, şimdilik buna hakim olmanız yeterli. </p><p id="62b7c032-932a-42b2-9240-205ed26191f9" class="">Bu sıra numarası segmentler karşı cihaza gittiğinde onları anlamlı bir bütün halinde sıralayıp işlemesini sağlarken aynı zamanda eksik olan segmentlerin de tespit edilmesine yardımcı olur. Böylece paketin yolculuğu sırasında kayıp bir paket varsa bu paketin gelmediğini ve yeniden gönderilmesi istenebilir. </p><p id="de3b5d4c-4c92-435d-b0d7-5eea71dcca46" class="">Belirlenen ilk sequence number karşı servera gittiğinde serverın bunu alıp cevap olarak kendine bir sequence number oluşturduğunu görüyoruz (1123822478). Tabii ki client’ın verileri kadar serverdan giden veriler de önemli olduğundan server da kendi segmentlerine sıra etiketi vuracak. Ama bunun yanında client’in gönderdiği pakette bir sorun olmadığını anlatmak için acknowledgment (onay) numarası belirlediğini görüyoruz. Bu acknowledgement değeri client’ın servera gönderdiği sequence number’ın 1 arttırılmış hali, aynı zamanda wireshark’ın gösterdiği next sequence number değeri. Server bunu pakete ekleyerek bir nevi 773125150. paketini almaya hazırım demiş oluyor. Böylece client’da 773125149. paketi tekrar göndermesine gerek olmadığını anlıyor. Son ACK paketine baktığımız zaman ise client, bir önceki sequence number’ı 1 arttırarak serverın beklediği sıradaki tcp paketini gönderirken, acknowledgment number’a ise server’ın sequence number’ını bir arttırıp göndererek onayını gerçekleştiriyor. Böylece paketlerin işlenme sırası belirlenirken aynı zamanda belirlenen değerlerle de client ve server birbirini tanımış, yani kimliklerini doğrulamış oluyor. Bir taşla iki kuş.</p><p id="e964c97b-c894-4d5a-9f8a-6d59a538198e" class="">Günün sonunda sequence ve acknowledgment number’ların iletişimin güvenliğinde sağladığı rolü de görmüş oluyoruz. TCP garip bir protokol değil mi? Her şeyi ne kadar da güvenlikle ilişkili. </p><h3 id="1bf8b744-a736-42e7-840f-c338a423e0dc" class="">4) Header Length</h3><p id="2f21e4b1-3304-485f-94a5-ee35d8ad647e" class="">Aynı zamanda Data Offset olarak da ifade edilir. Bu değer, TCP header içinde bulunan bölümlerin sayısını ve bu bölümlerin toplam uzunluğunu gösterir. Bu bölümler’den kastımız da şimdiye kadar saydığımız source port, destination port, sequence number, acknowledgement number, flags vs gibi alanlar. </p><figure id="ab75a555-e4a5-4aa8-b017-c383531547d7" class="image"><a href="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%2011.png"><img style="width:341px" src="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%2011.png"/></a></figure><p id="476d18f3-6aa3-4a1f-a4c7-66a400c474c6" class="">örneğin burada belirlenen Header Length TCP header boyutunun 20 bayt boyutunda olduğunu söylüyor. </p><p id="b894ebc3-2d7c-4967-a530-ed613c358507" class="">Bu neden önemli? TCP’de veri alanı TCP Header’dan sonraki byte&#x27;dan itibaren başlar. Biz karşı servera bir bir datayı TCP ile sarmalayıp gönderdiğimizde karşı serverın bu paketin içindeki datayı okumaya nereden başlayacağını bilmesi gerekiyor. Böylece datayı indexleyip, birleştirip bize anlamlı bir şekilde sunabilsin. Arkadaşınızın size attığı bir “merhaba” mesajına rastgele TCP headerından veriler sızmaması için önemlidir bu. Veya Transport katmanında çalışacak raw TCP paketlerini işleyen bir yazılım yazıyorsunuz, socketten verileri aldınız, bu verilerde hangi veriye nasıl ulaşacağınıza dair bir fonksiyon yazmak isterken yerini hesaplamanız için gereklidir bu bilgi. Artık öneminin gözünüzde canlandığını düşünerek devam edelim.</p><h3 id="f1fd7b15-3eff-41db-9efb-c4d941574a77" class="">5) Window Size</h3><figure id="229a90d0-b2ff-409d-8dc9-a154f5e59521" class="image"><a href="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%2012.png"><img style="width:361px" src="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%2012.png"/></a></figure><p id="4f65fa0d-fd28-4cea-afad-f0a016ab3cd7" class="">Transport Layer özelliklerinde gördüğümüz <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>Veri Segmentasyonu ve Birleştirme </strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>özellikleriyle <strong>Akış kontrolü</strong> burasıyla ilgilidir. Window Size gönderici ve alıcı cihazların <strong>TCP/IP stack&#x27;lerini yöneten işletim sistemi tarafından belirlenir.</strong> Window Size aslında işletim sisteminizin ilgili bağlantının kabul tarafı için kernelde ayırdığı hafıza alanı kadardır. Bir başka deyişle Window, alınan verileri uygulama katmanına yüklemeden önce depolayan bir buffer’dır. Window Size alanı, her an için buffer’da ne kadar yer olduğunu gösterir. Peki bu hikayeye bizi nereden bağlayacaksın? derseniz, bu hikaye bir DoS saldırısının ayak seslerini duymaya başladığımız yerdir.</p><p id="83b9ca6f-b6e8-4dbe-b997-99f046d3b039" class="">Saldırgan window size bilgisini sıfıra set ettiğinde karşı servera benim buffer’da yer kalmadı yavaş demiş olur. Server’ın buna inanmama gibi bir şansı yoktur haliyle server karşı tarafın buffer’ı ne zaman düzelecek diye kontrol etmek için window size probe paketlerini saldırgana gönderip durur. Ama saldırgan window size’ı değiştirmez, bu sürede server düşene bir tekme de ben vurmayayım bari deyip bağlantıyı süresiz olarak açık tutar.</p><p id="15da4ddb-910c-45c8-ad38-fe6c8d0da628" class="">Artık DoS’un nereden başladığını görmeye başladınız sanırım. Saldırgan aynı türden birçok porta aynı bağlantıyı kurar. Serverın portlar yeni kullanıcılara cevap veremez hale gelir.</p><p id="f203b2b6-0efd-4e92-865f-cb08fe642258" class="">Buna ek olarak saldırgan daha küçük, 2 gibi bir window size belirleyerek sunucuyu, göndereceği verileri çok küçük parçalara bölmeye zorlayabilir. </p><p id="797f203c-17eb-4e61-b144-423dc63ee836" class="">Bu konuda bir güvenlik açığını incelemek isterseniz, <strong>CVE-2008-4609 </strong>kodlu açığa bakabilirsiniz. Size bir link de bırakayım. </p><p id="37bee222-a938-4e76-809b-b426d09709e4" class=""><a href="https://learn.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-048">https://learn.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-048</a></p><h3 id="5666d4bd-88a7-40a5-9003-bfdc6b58164c" class="">6) Checksum</h3><figure id="62126741-7bae-4ce6-bdc6-3ffce9863c9d" class="image"><a href="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%2013.png"><img style="width:271px" src="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%2013.png"/></a></figure><p id="84aeee2a-eb4f-423e-aaee-ff0b3073ffee" class="">Checksum, veri paketlerinde bulunan veri ve header bilgilerinin bir toplamının belirli bir matematiksel işlem sonucu oluşturulan bir değerdir. Bu değer, veri paketlerinin iletim sırasında oluşabilecek hataları tespit etmek için kullanılır.</p><p id="c2097830-98b7-4ded-8f36-11645d026387" class="">TCP checksum algoritması,<strong> veri paketlerinin header bilgilerini ve içeriğindeki verileri 16 bitlik bloklar halinde böler.</strong> Bu blokların her birinin sayısal değeri toplanır ve sonuç, 65535&#x27;ten küçük bir sayı ise, bu sayı checksum değeri olarak kullanılır. Ancak sonuç 65535&#x27;ten büyük bir sayı ise, 65535&#x27;e mod alınarak checksum değeri hesaplanır.</p><p id="0fed41b2-d2db-4407-8c06-db08c62c165c" class=""><strong>Örneğin,</strong> veri paketinin header bilgileri ve içeriğindeki veriler toplamı &quot;11010101 01010101 11001100 00110011&quot; olsun. Bu veriler 16 bitlik bloklar halinde bölünür ve her bir blokun sayısal değeri toplanır:</p><p id="d7685d32-4318-47f8-956b-27fe5fd8d4ac" class="">11010101 01010101 = 21845
11001100 00110011 = 17731</p><p id="5ee1bcc8-e8e1-4ded-aeb9-1558cba6797f" class="">Toplam: 39576</p><p id="aadd0ca5-2ce9-4912-a8d1-e3f902c17d91" class="">Bu toplam, 65535&#x27;ten küçük bir sayı olduğu için, checksum değeri 39576 olarak kullanılır. Bu checksum değeri, veri paketinin header bilgilerine eklenir ve paket iletilerek gönderilir. Paketin hedef noktaya ulaştığında, hedef nokta tarafından paketin checksum değeri tekrar hesaplanır ve gönderilen checksum değeri ile karşılaştırılır. <strong>Eğer iki değer uyuşmuyorsa, bu hatalı bir paket olduğunu gösterir ve paket içeriği doğrulanamaz hale gelir.</strong> Bu durumda, paket hedef noktaya ulaştırılmaz ve gönderen tarafına bir hata mesajı gönderilir. Bu sayede, paket iletim sırasında oluşabilecek hatalar tespit edilebilir ve bu hataların düzgün bir şekilde işlenmesi sağlanır.</p><h3 id="098c83b3-5663-4ec7-b737-dc28db192d10" class="">7) Urgent Pointer</h3><figure id="06f0c3d2-8edc-4f0d-a398-0ca670dd9ca3" class="image"><a href="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%2014.png"><img style="width:176px" src="/assets/img/TCP%20ve%20IP%20Protokollerini%20Anlamak%201%20c4ccc2c7abbf46579f82f825fda32f24/Untitled%2014.png"/></a></figure><p id="264453ff-a693-4cfd-8032-a4e427c83f36" class="">Urgent pointer, veri paketinin iletim sırasında veriyi işleyecek <strong>end point</strong>’e acil bir durumun olup olmadığını belirtir.</p><p id="db9c7a3a-912d-4ca3-afc4-86b41aa97e51" class="">Eğer veri paketinin urgent pointer değeri <strong>0 değilse</strong>, bu veri paketinin acil bir durumu olduğu anlamına gelir ve veri paketinin işlenmesi sırasında öncelikli olarak işlenmesi gerekir. </p><p id="8ed04258-2367-43a5-b834-355a39717aa2" class="">Eğer sizin de aklınıza, o zaman giden paketlerin hepsini acil olarak işaretlesek routerlardan daha hızlı şekilde yönlendirilir bu da internet hızımızı arttırır gibi parlak bir fikir gelmişse bu kadar acele etmeyin. Burada dikkat etmeniz gereken nokta bu Acil durum işaretçisi (urgent pointer) ile işaretlenen verinin end pointte dikkate alındığıdır. E o zaman bu ne işimize yarayacak diye düşünmüşseniz Quota’da çok güzel bir örnek buldum. Meali:<div class="indented"><p id="7eaf439c-959a-499b-8ecb-b69c4a05f13d" class="">Diyelim ki telnet&#x27;te çok sayıda çıktı içeren ve yavaşça çıkan bir komut yazdınız, dolayısıyla buffer’a alındı. Sonra bundan sıkılırsınız ve durdurmak için c kontrolüne basarsınız. Ama artık çok geç. İstemi görmek için buffer’ın boşalmasını beklemeniz gerekir. Kurtarmak için urgent pointer yardımınıza koşar. Kuyrukta önündeki her şeyi siler, böylece istemi hemen görürsünüz.</p><p id="a7b0a58c-dd23-451f-a152-7733e8299f40" class="">
</p></div></p><p id="e590fb32-c781-46e3-b412-3c5a712ba7d7" class="">Eveeet. Uzun bir yolculuk oldu gibi. Buraya bir yere çadır kurabiliriz. Daha sonra IP protokolünden bahsetmek üzere yolculuğumuza devam edeceğiz. </p><p id="7253c0e4-9eb4-4a0d-a051-968302860b44" class=""></p><p id="16b22098-d9b3-4cf1-bf62-e02f37cb0f7c" class="">
</p><p id="7a07367a-878c-48bf-b1df-cbf4484c5e96" class="">
</p><p id="0f462d9a-6906-4673-9ff2-b07bf1fed926" class="">
</p><p id="6e6aa4e3-eb05-4884-bfbb-0af1ef0a3d5d" class="">
</p><p id="e5c11206-4d89-4d78-a9d6-c79c0449cb38" class=""> </p><p id="6ff8e9ac-557a-478e-8968-02d7ff309b7d" class="">
</p></div></article></body></html>
